# Работа с сетевыми дисками.

# Темы, затронутые в лекции 1: 

1. [`Сетевые диски в сетях Microsoft`](https://github.com/Shin0kari/System-administration/blob/main/lections/Lec_13.%20Working%20with%20network%20drives.md#%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5-%D0%B4%D0%B8%D1%81%D0%BA%D0%B8-%D0%B2-%D1%81%D0%B5%D1%82%D1%8F%D1%85-microsoft)

1. [`Создание сетевых дисков в Windows Server 2012r2`](https://github.com/Shin0kari/System-administration/new/main/lections#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85-%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2-%D0%B2-windows-server-2012r2)

1. [`Создание сетевых дисков с использованием протокола SMB в GNU/Linux`](https://github.com/Shin0kari/System-administration/new/main/lections#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85-%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D0%B0-smb-%D0%B2-gnulinux)

***

## Сетевые диски в сетях Microsoft.
###### [`Вернутся вверх`](https://github.com/Shin0kari/System-administration/new/main/lections#%D1%82%D0%B5%D0%BC%D1%8B-%D0%B7%D0%B0%D1%82%D1%80%D0%BE%D0%BD%D1%83%D1%82%D1%8B%D0%B5-%D0%B2-%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D0%B8-1)

При использовании MS AD для централизованной авторизации и аутентификации практически всегда создаётся один или несколько сетевых дисков для хранения информации пользователей на сервере.

У централизованного хранения данных есть два преимущества:

Во 1-ых, это позволяет увеличить надёжность за счёт регулярного резервного копирования. 

Во 2-ых, данные пользователя не привязаны к конкретной рабочей станции, что позволяет работать на любом компьютере организации и при необходимость быстро провести его замену при выходе их строя.

Сетевые диски можно использовать даже для хранения профиля пользователя, что позволяет прозрачно для пользователя переносить настройки с одной рабочей машины на другую. 

Для обмена данными с сервером при использовании сетевых дисков применяется протокол SMB (CIFS).

Изначально протокол SMB работал поверх серей IPX/SPX с использованием NetBIOS. В Windows 2000 произошёл переход на сети TCP/IP, но многие механизмы NetBIOS остались на месте. 

Это требовало как дополнительных служб, так и генерировала дополнительный сетевой трафик. В версии 2.0, появившейся в 2006 году произошёл окончательный переход на TCP/IP и значительное упрощение протокола для увеличения скорости его работы.

 2012 году вышла версия протокола 3.0, расширяющая его возможности под современные требования, но без черезмерного усложнения, как в первой версии.

Знание существующих версий необходимо, так как сейчас можно встретить системы с разной версией протокола. В версии 1,0 и используемых в ней протоколах NTLM найдено множество уязвимостей, которые уже не могут быть исправлены и едиснственным способом защиты является переход на новую версию.

## Создание сетевых дисков в Windows Server 2012r2.
###### [`Вернутся вверх`](https://github.com/Shin0kari/System-administration/new/main/lections#%D1%82%D0%B5%D0%BC%D1%8B-%D0%B7%D0%B0%D1%82%D1%80%D0%BE%D0%BD%D1%83%D1%82%D1%8B%D0%B5-%D0%B2-%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D0%B8-1)

Все необходимые компоненты для работы сетевых дисков устанавливаются в Windows Server вместе с операционной системой. Для создания сетевых дисков можно воспользоваться двумя путями:

* использование контекстного меню на имени папки
* использование Server Manager

В обоих случаях нужно заранее определиться, какой каталог файловой системы будет экспортирвоаться как общий по сети и под каким именем он будет виден пользователям. Это внешнее имя никак не связано с именованием внутри сервера и его файловой системы и ограничено только требованиями к именам объектов в UNC пути.

Необходимо помнить, что в случае использования сетевых дисков (это касается и Windows, и Linux) отдельно существуют права доступа к сетевому диску и доступа к объектам файловой системы. Вполне реальна ситуация, в которой правами на сетевой ресурс пользователю разрешается всё, но из-за ошибочного назначения прав на каталог файловой системы он не может даже посмотреть содержимое сетевой папки.

При использовании контекстного меню необходимо найти папку, которую хочется превратить в сетевой диск, щёлкнуть на ней правой кнопкой мыши и выбрать пункт "свойства" (properties).

В одной из вкладок будет доступен пункт "сделать общими" (Share). 

Есть два варианта настройки - простой (небольшое количество заранее предопределённых шаблонов прав доступа) и расширенный, позволяющий поменять права любым образом и выбрать любое имя сетевого ресурса. 

При использовании Server Manager в левой панели должен быть пункт File and storage services.

При выборе указанного пункта появляется список всех сетевых дисков, настроенных на данном компьютере. В правом верхнем углу будет доступно меню "Tasks", содержащее пункт "New Share...", запускающий мастер создания сетевых папок.

При указании прав доступа можно использовать как имена конкретных пользователей, так и группы.

Для авторизации в любой доменной системе используется учётная запись, применённая для входа на компьютер. 

Для некоторых систем, разработчиком которых не является Microsoft доступно отключение этих механизмов и дополнительный вход с использоватем имени пользователя и пароля.

Оба рассматриваемых способа позволяют создать сетевой диск и выделить права доступа к нему. Для управлением правами доступа внутри сетевого диска понадобится менять права на доступ к объектам файловой системы.

## Создание сетевых дисков с использованием протокола SMB в GNU/Linux.
###### [`Вернутся вверх`](https://github.com/Shin0kari/System-administration/new/main/lections#%D1%82%D0%B5%D0%BC%D1%8B-%D0%B7%D0%B0%D1%82%D1%80%D0%BE%D0%BD%D1%83%D1%82%D1%8B%D0%B5-%D0%B2-%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D0%B8-1)

Для создания сетевых дисков в GNU/Linux можно использовать два протокола и, соответственно, две отдельные службы.

Первая является родной для всех систем, выросших их Unix - NFS. 

Второй вариант для сетевых дисков - служба samba. В неё входит два компонента - сама samba и winbind, отвечающий за пространство имён пользователей и их аутентификацию. 

Текущая версия samba способна работать в MS AD в качестве файлового сервера практически без ограничений, хотя часть возможностей работает негарантировано и появляется значительно позже, чем в windows server.

К специфическим особенностям samba следует отнести отсутствие графических интерфейсов для создания сетевых дисков и необходимость ручной настройки конфигурационных файлов для начал работы с MS AD. 

После корректной настройки предоставляемые сетевые диски можно будет настраивать и обслуживать с клиентов MS Windows, как и при использовании родных серверов.

###### [`Вернутся вверх`](https://github.com/Shin0kari/System-administration/new/main/lections#%D1%82%D0%B5%D0%BC%D1%8B-%D0%B7%D0%B0%D1%82%D1%80%D0%BE%D0%BD%D1%83%D1%82%D1%8B%D0%B5-%D0%B2-%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D0%B8-1)
